<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Same-Same but different: A Dive Into Keyless-polymorphism</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Same-Same but different: A Dive Into Keyless-polymorphism</h1>
</header>
<section data-field="subtitle" class="p-summary">
TL;DR: Change bytes to change the look and signature of your files without changing the functionality and without modifying the source…
</section>
<section data-field="body" class="e-content">
<section name="b3a7" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="0fee" id="0fee" class="graf graf--h3 graf--leading graf--title">Same-Same but different: A Dive Into Keyless-polymorphism</h3><p name="fb9f" id="fb9f" class="graf graf--p graf-after--h3"><em class="markup--em markup--p-em">TL;DR: Change bytes to change the look and signature of your files without changing the functionality and without modifying the source code.</em></p><p name="4b73" id="4b73" class="graf graf--p graf-after--p">I was initially introduced to this concept when studying for the eLearnSecurity Certified Reverse Engineer (eCRE), where the concept was presented as NOP obfuscation. A couple of years later I stumbled on the amazing presentation ‘Morph your malware’ by Sebastian Feldmann a.k.a. Code White (linked below). The concept is beautiful in its simplicity! In this article we are going through the steps of understanding what is happening, why it works and how we can implement a very simple version of this for ourselves.</p><figure name="7f9b" id="7f9b" class="graf graf--figure graf--iframe graf-after--p"><iframe src="https://www.youtube.com/embed/AucQUjJBJuw?feature=oembed" width="700" height="393" frameborder="0" scrolling="no"></iframe><figcaption class="imageCaption">Talk on malware obfuscation</figcaption></figure><p name="8afc" id="8afc" class="graf graf--p graf-after--figure">So the main idea is that we go through our code and replace ASM instructions where we have a suitable replacement that essentially does the same. An example of this is:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="objectivec" name="e20b" id="e20b" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">NOP</span></pre><p name="be29" id="be29" class="graf graf--p graf-after--pre">is replaced with</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="sql" name="5aef" id="5aef" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">INC EAX<br /><span class="hljs-type">DEC</span> EAX</span></pre><p name="323a" id="323a" class="graf graf--p graf-after--pre">both do the same: nothing! this can be more or less complex.</p><p name="d3af" id="d3af" class="graf graf--p graf-after--p">To get the most out of this post, I would recommend at least some experience with the following:</p><ul class="postList"><li name="e131" id="e131" class="graf graf--li graf-after--p">debugging and reverse engineering x86/64</li><li name="da8f" id="da8f" class="graf graf--li graf-after--li">a basic understanding of x86 assembly (ASM)</li><li name="a28d" id="a28d" class="graf graf--li graf-after--li">basic scripting and programming experience</li></ul><p name="bb27" id="bb27" class="graf graf--p graf-after--li">I&#39;ll do my best to explain as I go and provide resources and references but this is not a substitute for understanding the concepts above.</p><p name="d277" id="d277" class="graf graf--p graf-after--p">The post will have the following structure:</p><ul class="postList"><li name="a0f6" id="a0f6" class="graf graf--li graf-after--p">Back to basics — Manual PoC of the concept using a debugger</li><li name="800c" id="800c" class="graf graf--li graf-after--li">A bit of testing before the main show — Manual modification of a binary file to show it works</li><li name="1237" id="1237" class="graf graf--li graf-after--li">Automation — writing a basic script to implement a very simple version of the concept</li><li name="6fc0" id="6fc0" class="graf graf--li graf-after--li">Homework and Conclusion — ideas of how we can expand on the topic and wrap up loose ends</li></ul><p name="57cd" id="57cd" class="graf graf--p graf-after--li">For a functional and fleshed-out version please refer to Sebastian&#39;s GitHub:</p><div name="d391" id="d391" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://github.com/codewhitesec/Lastenzug/tree/main/LastenPIC/SpiderPIC" data-href="https://github.com/codewhitesec/Lastenzug/tree/main/LastenPIC/SpiderPIC" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://github.com/codewhitesec/Lastenzug/tree/main/LastenPIC/SpiderPIC"><strong class="markup--strong markup--mixtapeEmbed-strong">Lastenzug/LastenPIC/SpiderPIC at main · codewhitesec/Lastenzug</strong><br><em class="markup--em markup--mixtapeEmbed-em">Socks4a proxy leveraging PIC, Websockets and static obfuscation on assembly level - Lastenzug/LastenPIC/SpiderPIC at…</em>github.com</a><a href="https://github.com/codewhitesec/Lastenzug/tree/main/LastenPIC/SpiderPIC" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="424cf5defd87220beb30a446d5be58a0" data-thumbnail-img-id="0*SopBEzJpV377nzI9" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*SopBEzJpV377nzI9);"></a></div><p name="1af4" id="1af4" class="graf graf--p graf-after--mixtapeEmbed">But enough time wasting, let&#39;s get into it!</p><h3 name="4557" id="4557" class="graf graf--h3 graf-after--p">Back to basics</h3><p name="7821" id="7821" class="graf graf--p graf-after--h3">First things first, where is the code we are trying to modify located? simple it in the .text section, read this article for more details:</p><div name="9d81" id="9d81" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://0xrick.github.io/win-internals/pe5/" data-href="https://0xrick.github.io/win-internals/pe5/" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://0xrick.github.io/win-internals/pe5/"><strong class="markup--strong markup--mixtapeEmbed-strong">A dive into the PE file format - PE file structure - Part 4: Data Directories, Section Headers and…</strong><br><em class="markup--em markup--mixtapeEmbed-em">A dive into the PE file format - PE file structure - Part 4: Data Directories, Section Headers and Sections…</em>0xrick.github.io</a><a href="https://0xrick.github.io/win-internals/pe5/" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="dc60d4d2773e254786b0c2a96dc2d996" data-thumbnail-img-id="0*ptFqhMVPqC8G3iGF" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*ptFqhMVPqC8G3iGF);"></a></div><p name="1396" id="1396" class="graf graf--p graf-after--mixtapeEmbed">But since I like to see it for myself, let&#39;s spin up CFF Explorer and x64dbg and see it for ourselves. For the x64dbg view to match the start of the .text section please notice that this is not at the entry point of the application. So to get there, go to the memory map &gt; select the .text section of the binary &gt; click follow in disassembly. As for the application we are looking at it is just a single line of nim:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="bash" name="d540" id="d540" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;keylessPolymorphism&quot;</span></span></pre><p name="d2fd" id="d2fd" class="graf graf--p graf-after--pre">The image below shows the two programs side by side, the different coloured areas represent the instructions and show how they relate.</p><figure name="0152" id="0152" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*K8-HjABMTNT_G84Gxph1Ng.png" data-width="1166" data-height="944" src="https://cdn-images-1.medium.com/max/800/1*K8-HjABMTNT_G84Gxph1Ng.png"><figcaption class="imageCaption">Verify executable code</figcaption></figure><p name="3572" id="3572" class="graf graf--p graf-after--figure">Now let&#39;s first try to manually edit one of the instructions and see if the application still works. But since NOP is really if ever used let&#39;s go on the hunt for something more interesting to modify. So let&#39;s get some inspiration from the original inspiration: <a href="https://github.com/codewhitesec/Lastenzug/blob/main/LastenPIC/SpiderPIC/src/substitutions.go" data-href="https://github.com/codewhitesec/Lastenzug/blob/main/LastenPIC/SpiderPIC/src/substitutions.go" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">https://github.com/codewhitesec/Lastenzug/blob/main/LastenPIC/SpiderPIC/src/substitutions.go</a></p><p name="7f50" id="7f50" class="graf graf--p graf-after--p">I&#39;ll go with the following example:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="fd33" id="fd33" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">var</span> substitutionsMov <span class="hljs-operator">=</span> [<span class="hljs-operator">...</span>]string{<br /> <span class="hljs-string">&quot;<span class="hljs-subst">\t</span>push [REG]<span class="hljs-subst">\n</span><span class="hljs-subst">\t</span>pop [REG1]<span class="hljs-subst">\n</span>&quot;</span>,<br />}</span></pre><p name="a0f8" id="a0f8" class="graf graf--p graf-after--pre">Here as the name suggests we are substituting the simple move command with PUSH and POP. If you are not a skilled assembly warrior, here is a short explanation.</p><p name="a9d3" id="a9d3" class="graf graf--p graf-after--p">The MOV instruction moves data from one register to another. Whereas the PUSH instruction takes the value of a register (or just a value) and moves it to the top of the stack, and then the POP instruction takes the top value from the stack and POPs it into a register. If you don’t know this then it&#39;s a perfect time to brush up on your ASM skills (you just need to know how instructions, registers, and the stack work and you should be able to follow along), here is a guide that should have you covered: <a href="https://www.cs.virginia.edu/~evans/cs216/guides/x86.html" data-href="https://www.cs.virginia.edu/~evans/cs216/guides/x86.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">https://www.cs.virginia.edu/~evans/cs216/guides/x86.html</a></p><p name="e4bc" id="e4bc" class="graf graf--p graf-after--p">I was not able to create a proper example of this myself, so I just went to everybody&#39;s favourite test example calc.exe. After we press continue and get to the entry point we quickly find a useful instruction for us to play with</p><figure name="170a" id="170a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*n20IKMWdODGBcsXQsA1ZRg.png" data-width="786" data-height="154" src="https://cdn-images-1.medium.com/max/800/1*n20IKMWdODGBcsXQsA1ZRg.png"><figcaption class="imageCaption">MOV instruction in calc</figcaption></figure><p name="a290" id="a290" class="graf graf--p graf-after--figure">We will now try to change the MOV instruction highlighted above. Since I already stepped past it I just set a breakpoint above and restart execution to get back. Now following the example above we need to change the code, to make sure we are doing it correctly let&#39;s look at the documentation for the functions (from <a href="https://www.cs.virginia.edu/~evans/cs216/guides/x86.html" data-href="https://www.cs.virginia.edu/~evans/cs216/guides/x86.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">https://www.cs.virginia.edu/~evans/cs216/guides/x86.html</a>):</p><figure name="7835" id="7835" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*poghdS-owi8SYPUuDhLkzQ.png" data-width="861" data-height="147" src="https://cdn-images-1.medium.com/max/800/1*poghdS-owi8SYPUuDhLkzQ.png"><figcaption class="imageCaption">Documentation for MOV</figcaption></figure><figure name="bd00" id="bd00" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*jQAQ_GZA5ZlpR2Gug8uijw.png" data-width="827" data-height="522" src="https://cdn-images-1.medium.com/max/800/1*jQAQ_GZA5ZlpR2Gug8uijw.png"><figcaption class="imageCaption">PUSH and POP</figcaption></figure><p name="9a9c" id="9a9c" class="graf graf--p graf-after--figure">For this example, we will substitute RBP and RSP with respectively ECX and EAX, since the tool used to demonstrate the changing values only supports x32 naming. The relevant info is highlighted above, this means that our replacement for the MOV ECX, EAX instruction should be:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="perl" name="b160" id="b160" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">push</span> EAX<br /><span class="hljs-keyword">pop</span> ECX</span></pre><p name="1e1e" id="1e1e" class="graf graf--p graf-after--pre">Quick side note, if this still does not make any sense and you just want to play around with a limited version of ASM here is a great emulation where you can see how instructions interact with registers:</p><div name="b2f1" id="b2f1" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://kobzol.github.io/davis/" data-href="https://kobzol.github.io/davis/" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://kobzol.github.io/davis/"><strong class="markup--strong markup--mixtapeEmbed-strong">Assembly debugger (x86)</strong><br><em class="markup--em markup--mixtapeEmbed-em">Edit description</em>kobzol.github.io</a><a href="https://kobzol.github.io/davis/" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="ab0380da587cef2816be8357ceddb622"></a></div><p name="72b8" id="72b8" class="graf graf--p graf-after--mixtapeEmbed">and this is how the code looks like after execution, note that starting out EAX is set to 420, and ECX is set to 69, after the MOV instruction ECX is overwritten with the EXA value.</p><figure name="624a" id="624a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*bmz25aqe85PmI0qFPUepVQ.png" data-width="790" data-height="263" src="https://cdn-images-1.medium.com/max/800/1*bmz25aqe85PmI0qFPUepVQ.png"><figcaption class="imageCaption">MOV example</figcaption></figure><p name="242a" id="242a" class="graf graf--p graf-after--figure">Now let&#39;s try with the PUSH/POP instructions</p><figure name="3481" id="3481" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*EEHkcJdLbLYRcgx-YqT4QQ.png" data-width="772" data-height="269" src="https://cdn-images-1.medium.com/max/800/1*EEHkcJdLbLYRcgx-YqT4QQ.png"><figcaption class="imageCaption">PUSH/POP example</figcaption></figure><p name="ca96" id="ca96" class="graf graf--p graf-after--figure">We see that the output is exactly the same, now let&#39;s try it in the debugger, first, however, we need the opcodes for the instructions, i.e. the hexadecimal values for the instructions.</p><div name="d4c7" id="d4c7" class="graf graf--mixtapeEmbed graf-after--p"><a href="http://sparksandflames.com/files/x86InstructionChart.html" data-href="http://sparksandflames.com/files/x86InstructionChart.html" class="markup--anchor markup--mixtapeEmbed-anchor" title="http://sparksandflames.com/files/x86InstructionChart.html"><strong class="markup--strong markup--mixtapeEmbed-strong">Intel x86 Assembler Instruction Set Opcode Table</strong><br><em class="markup--em markup--mixtapeEmbed-em">An ModR/M byte follows the opcode and specifies the operand. The operand is either a SIMD floating-point register or a…</em>sparksandflames.com</a><a href="http://sparksandflames.com/files/x86InstructionChart.html" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="54377df208aae233bd4564ef37b25ec0" data-thumbnail-img-id="0*90hl_0a_uGc75UKi" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*90hl_0a_uGc75UKi);"></a></div><figure name="8d3b" id="8d3b" class="graf graf--figure graf-after--mixtapeEmbed"><img class="graf-image" data-image-id="1*36KYW8EiGtk2fouVnNo64g.png" data-width="1121" data-height="606" src="https://cdn-images-1.medium.com/max/800/1*36KYW8EiGtk2fouVnNo64g.png"><figcaption class="imageCaption">Opcode reference guide</figcaption></figure><p name="4cb2" id="4cb2" class="graf graf--p graf-after--figure">In x64dbg right click &gt; Binary &gt; Edit and enter the opcodes above, this will result in:</p><figure name="3f06" id="3f06" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*1jTcfcyecfFHJWT0fXZYhg.png" data-width="764" data-height="98" src="https://cdn-images-1.medium.com/max/800/1*1jTcfcyecfFHJWT0fXZYhg.png"><figcaption class="imageCaption">Modified instructions</figcaption></figure><p name="c25a" id="c25a" class="graf graf--p graf-after--figure">Now to make sure that we are not messing up, let&#39;s try running the program without the modifications and then with the modifications and inspect the registers after each to make sure. Please note that the difference above is just RAX is the 64-bit register and EAX is the 32-bit, I don&#39;t think this makes a difference here, but else we will find out shortly. To check this easily I just put a breakpoint on the instruction in question.</p></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="2"><figure name="1102" id="1102" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--p" style="width: 50.228%;"><img class="graf-image" data-image-id="1*mmgs-XxCHY6_qsJMyhd28w.png" data-width="175" data-height="106" src="https://cdn-images-1.medium.com/max/600/1*mmgs-XxCHY6_qsJMyhd28w.png"></figure><figure name="ee23" id="ee23" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 49.772%;"><img class="graf-image" data-image-id="1*a3I9_v2mZ_qgubthQ9q8aQ.png" data-width="180" data-height="110" src="https://cdn-images-1.medium.com/max/600/1*a3I9_v2mZ_qgubthQ9q8aQ.png"><figcaption class="imageCaption" style="width: 200.916%; left: -100.916%;">Original: pre (left) and post (right)</figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="2deb" id="2deb" class="graf graf--p graf-after--figure">This is a very good example as it just overwrites an empty register. Let&#39;s now try with the PUSH/POP modification and inspect the results.</p></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="2"><figure name="9879" id="9879" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--p" style="width: 50.373%;"><img class="graf-image" data-image-id="1*UTYpL9j2Bv-q0JGCNKWpCg.png" data-width="175" data-height="108" src="https://cdn-images-1.medium.com/max/800/1*UTYpL9j2Bv-q0JGCNKWpCg.png"></figure><figure name="35aa" id="35aa" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 49.627%;"><img class="graf-image" data-image-id="1*rNN9kCyxaVynULRywlp2Rw.png" data-width="174" data-height="109" src="https://cdn-images-1.medium.com/max/600/1*rNN9kCyxaVynULRywlp2Rw.png"><figcaption class="imageCaption" style="width: 201.503%; left: -101.503%;">Modified: pre (left) and post (right)</figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="48df" id="48df" class="graf graf--p graf-after--figure">And the results are the same, just as we wanted them to be, now we just execute the program to see if it behaves as expected! Also notice that since the original instruction was 16 bit longer than what we replaced it with we filled the remaining space with an NOP instruction, this we will need to take into account for the final version. And it still works, now we know that we can replace instructions at an assembly level and know that the binary still works.</p><h3 name="e284" id="e284" class="graf graf--h3 graf-after--p">A bit of testing before the main show</h3><p name="48ec" id="48ec" class="graf graf--p graf-after--h3">Now that we have our core idea confirmed, let&#39;s have a look at testing this out, for this, we will manually modify the bytes in the binary and see if it still runs, for this, we will be using CFF Explorer but any hex editor will work just fine. To find where we need to edit we can just right-click in x64dbg and say ‘copy file offset’, this gives 0x6AA. and comparing like we did earlier with colours we can confirm if we found the right instructions.</p><figure name="403d" id="403d" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*WG5B1exYxmxFwWhgf2N_IA.png" data-width="1499" data-height="770" src="https://cdn-images-1.medium.com/max/800/1*WG5B1exYxmxFwWhgf2N_IA.png"><figcaption class="imageCaption">Compare code</figcaption></figure><p name="2ade" id="2ade" class="graf graf--p graf-after--figure">The green area above shows where we need to edit, now let&#39;s edit the file like we did in the debugger, after this is done we save the file with a new name.</p><figure name="5e87" id="5e87" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*J0yXl_DvFDrTereJlV1KAA.png" data-width="641" data-height="316" src="https://cdn-images-1.medium.com/max/800/1*J0yXl_DvFDrTereJlV1KAA.png"><figcaption class="imageCaption">Modified code</figcaption></figure><p name="81c8" id="81c8" class="graf graf--p graf-after--figure">Let&#39;s see if it runs! And it does!</p><h3 name="e6d7" id="e6d7" class="graf graf--h3 graf-after--p">Automation</h3><p name="6c87" id="6c87" class="graf graf--p graf-after--h3">Now that we know that we can modify a binary file with substitution code, let&#39;s whip up a script to do this for us. But before we can do this, let&#39;s generally define what it needs to do, and then we can go about implementing it.</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="vbnet" name="389c" id="389c" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">Scan through <span class="hljs-keyword">binary</span> <span class="hljs-keyword">for</span> matching instructions i.e. MOV REG1, REG0<br />Print the address <span class="hljs-keyword">of</span> the matched instruction<br />Replace instruction <span class="hljs-keyword">with</span> PUSH/POP<br /><span class="hljs-keyword">Skip</span> remaining bytes <span class="hljs-keyword">of</span> original instruction<br />Save <span class="hljs-keyword">as</span> <span class="hljs-built_in">new</span> file</span></pre><p name="6734" id="6734" class="graf graf--p graf-after--pre">Some things to note, I&#39;m writing this as I&#39;m figuring things out myself so it might require some trial and error, but hey, that is where learning happens.</p><p name="86fe" id="86fe" class="graf graf--p graf-after--p">I anticipate that there may be issues with the following parts of the above code:</p><ul class="postList"><li name="2a99" id="2a99" class="graf graf--li graf-after--p">if we change the size of .text there might be issues with base relocations</li><li name="c7e8" id="c7e8" class="graf graf--li graf-after--li">If we substitute with instructions that require more space then we might run into issues with the file&#39;s PE header</li></ul><p name="a33c" id="a33c" class="graf graf--p graf-after--li">Either this can be done with a simple file I/O or we need to use some type of disassembler. So after many hours of messing around with different ideas, making a PoC of a disassembler etc. and a bunch of research, I came to the conclusion that we have the following requirements:</p><ul class="postList"><li name="cf41" id="cf41" class="graf graf--li graf-after--p">we need something that can parse the instructions of the intel x86–64 file i.e. a disassembler</li><li name="a166" id="a166" class="graf graf--li graf-after--li">We need the offsets of these instructions</li></ul><p name="7c13" id="7c13" class="graf graf--p graf-after--li">The simplest way I found to do this was just using objdump</p><figure name="5630" id="5630" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*_MZfBTlGzVTvBnTTFvyHmg.png" data-width="524" data-height="679" src="https://cdn-images-1.medium.com/max/800/1*_MZfBTlGzVTvBnTTFvyHmg.png"><figcaption class="imageCaption">Objdump output</figcaption></figure><p name="1c55" id="1c55" class="graf graf--p graf-after--figure">Now we have the instructions and their offsets, next we need to parse these.</p><p name="e906" id="e906" class="graf graf--p graf-after--p">Struct for parsing:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="python" name="f577" id="f577" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-meta">@dataclass</span><br /><span class="hljs-keyword">class</span> <span class="hljs-title class_">instructionStruct</span>:<br />    <span class="hljs-string">&quot;&quot;&quot; Class to represent line of instruction &quot;&quot;&quot;</span><br />    offset: <span class="hljs-built_in">int</span><br />    <span class="hljs-built_in">bytes</span>: <span class="hljs-built_in">str</span><br />    instruction: <span class="hljs-built_in">str</span></span></pre><h4 name="d7fa" id="d7fa" class="graf graf--h4 graf-after--pre">parsing code</h4><p name="4eea" id="4eea" class="graf graf--p graf-after--h4">for the parsing, I got lazy and just used regular expressions (regex) to extract the different values. A short side note, objdump has a fixed width when outputting format unless the -w flag is used. So for the parsing to be done properly we use the following command line:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="bash" name="336f" id="336f" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">objdump --disassemble -w ./calc_modified.exe  </span></pre><p name="4092" id="4092" class="graf graf--p graf-after--pre">For the writing of the regex I used this website to prototype and make my life overall easier:</p><div name="1e8b" id="1e8b" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://regex101.com/" data-href="https://regex101.com/" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://regex101.com/"><strong class="markup--strong markup--mixtapeEmbed-strong">regex101: build, test, and debug regex</strong><br><em class="markup--em markup--mixtapeEmbed-em">Regular expression tester with syntax highlighting, explanation, cheat sheet for PHP/PCRE, Python, GO, JavaScript…</em>regex101.com</a><a href="https://regex101.com/" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="31760270da2559a247a64a82b5848975" data-thumbnail-img-id="0*SfTAAVzG9YVBFK8f" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*SfTAAVzG9YVBFK8f);"></a></div><p name="333e" id="333e" class="graf graf--p graf-after--mixtapeEmbed">Now let&#39;s implement them in Python and see if they work, the code will be for prototyping and not optimized. The code below will first get the fileOffset, i.e. the offset of the text section and then use a combination of regular expressions to extract the various values to fill the instructionStruct. Lastly, it will return a list of everything it found.</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="python" name="d38e" id="d38e" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">def</span> <span class="hljs-title function_">parseObjdump</span>(<span class="hljs-params">objdumpString</span>):<br />    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] Parsing objdump and returning instruction list&quot;</span>)<br />    fileOffset = re.findall(<span class="hljs-string">&quot;([0-9,a-z].*)\s&lt;.text&gt;:&quot;</span>, objdumpString)<br />    fileOffsetInt = <span class="hljs-built_in">int</span>(fileOffset[<span class="hljs-number">0</span>], <span class="hljs-number">16</span>)<br />    instructionList = []<br />    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> objdumpString.splitlines():<br />        offset = re.findall(<span class="hljs-string">&quot;^\s{3}([0-9,a-z].*):&quot;</span>, line)<br />        instruction = re.findall(<span class="hljs-string">&quot;[0-9a-z](\s{2,})([a-z].*)&quot;</span>, line)<br />        <span class="hljs-comment"># also need bytes</span><br />        <span class="hljs-keyword">try</span>:<br />            <span class="hljs-built_in">bytes</span> = line.replace(instruction[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>],<span class="hljs-string">&#x27;&#x27;</span>)<br />            <span class="hljs-built_in">bytes</span> = <span class="hljs-built_in">bytes</span>.replace(offset[<span class="hljs-number">0</span>],<span class="hljs-string">&#x27;&#x27;</span>)<br />            <span class="hljs-built_in">bytes</span> = <span class="hljs-built_in">bytes</span>.strip()<br />            <span class="hljs-built_in">bytes</span> = <span class="hljs-built_in">bytes</span>.replace(<span class="hljs-string">&#x27;:\t&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)<br />            instructionList.append(instructionStruct(<span class="hljs-built_in">int</span>(offset[<span class="hljs-number">0</span>], <span class="hljs-number">16</span>) - fileOffsetInt, <span class="hljs-built_in">bytes</span>, instruction[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]))<br />        <span class="hljs-keyword">except</span>:<br />            error = instructionList<br />    <span class="hljs-keyword">return</span> instructionList</span></pre><p name="894c" id="894c" class="graf graf--p graf-after--pre">Running the above code against the .text section of calc.exe provides the following output.</p><figure name="2be6" id="2be6" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*3ynTKB-pZjrgJx7cdOoCYw.png" data-width="855" data-height="342" src="https://cdn-images-1.medium.com/max/800/1*3ynTKB-pZjrgJx7cdOoCYw.png"><figcaption class="imageCaption">parsed .text section (mnemonic was renamed to instruction for consistency)</figcaption></figure><p name="2dda" id="2dda" class="graf graf--p graf-after--figure">Now let&#39;s create a regex that looks for the value we want to replace. Remember we are trying to replace MOV and any combination of two registers. Again we use some regex magic.</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="css" name="adb4" id="adb4" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">for instruction in instructionList:<br />    movRegex = <span class="hljs-string">&quot;mov\s*(%[r][abcd]x|%[r][b][ip]),(%[r][abcd]x|%[r][bsd][ip])&quot;</span><br />    if re.<span class="hljs-built_in">findall</span>(movRegex, instruction.instruction):<br />        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\t[&gt;] MOV found at:&quot;</span>, <span class="hljs-built_in">hex</span>(instruction.offset))</span></pre><p name="a46a" id="a46a" class="graf graf--p graf-after--pre">Let&#39;s run it and verify the output:</p><figure name="4489" id="4489" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*QIILbRB0kerAVZIv3-eWTw.png" data-width="1120" data-height="443" src="https://cdn-images-1.medium.com/max/800/1*QIILbRB0kerAVZIv3-eWTw.png"><figcaption class="imageCaption">Output verification</figcaption></figure><p name="fe85" id="fe85" class="graf graf--p graf-after--figure">The next step is to change the bytes in the file. So first we need to parse the PE header to get the location of the .text section and then overwrite the correct byte. For this we need to parse the section headers, we will be using the pefile library in Python <a href="https://github.com/erocarrera/pefile/blob/wiki/UsageExamples.md#introduction" data-href="https://github.com/erocarrera/pefile/blob/wiki/UsageExamples.md#introduction" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">https://github.com/erocarrera/pefile/blob/wiki/UsageExamples.md#introduction</a>. here it is named PointerToRawData.</p></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="2"><figure name="7de4" id="7de4" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--p" style="width: 40.802%;"><img class="graf-image" data-image-id="1*mJfvW7vKHolsDmzKdNzwSg.png" data-width="851" data-height="624" src="https://cdn-images-1.medium.com/max/600/1*mJfvW7vKHolsDmzKdNzwSg.png"></figure><figure name="a776" id="a776" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 59.198%;"><img class="graf-image" data-image-id="1*-oOoxusvQb679UeYReiXOw.png" data-width="849" data-height="429" src="https://cdn-images-1.medium.com/max/800/1*-oOoxusvQb679UeYReiXOw.png"><figcaption class="imageCaption" style="width: 168.925%; left: -68.925%;">Left: view of section headers | right: data at rawOffset</figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="6f3d" id="6f3d" class="graf graf--p graf-after--figure">To test that we can overwrite bytes, I initially just overwrote matches with NOP, and it works.</p><figure name="94b0" id="94b0" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*qJ9mcFYvYI6HEM0BTnwrqA.png" data-width="994" data-height="324" src="https://cdn-images-1.medium.com/max/800/1*qJ9mcFYvYI6HEM0BTnwrqA.png"><figcaption class="imageCaption">NOP overwrites</figcaption></figure><p name="d095" id="d095" class="graf graf--p graf-after--figure">Now the last step is to extract the registers from the instruction, and then overwrite them with the correct bytes.</p><p name="8868" id="8868" class="graf graf--p graf-after--p">Since we are doing this in a 64-bit process we cannot modify the 32-bit registers with the process above as this will potentially overwrite important data. For testing I&#39;m using accesscheck64.exe from sysinternals, this was mainly due to the amount of MOV instructions in the binary.</p><p name="4098" id="4098" class="graf graf--p graf-after--p">First things first we need to get the test section from the PE</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="makefile" name="943f" id="943f" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">peFilePath = <span class="hljs-string">&quot;accesschk64.exe&quot;</span><br />pe = pefile.PE(peFilePath)<br />textOffset = getTextOffset(pe)<br />pe.close()<br />print(<span class="hljs-string">&quot;[+] .text offset:&quot;</span>, hex(textOffset))</span></pre><p name="3aac" id="3aac" class="graf graf--p graf-after--pre">The next step is to go through the file using the regex we made earlier to find suitable MOV instructions and parse the info we need, namely the registers used, and then convert this to the relevant byte code for the desired operation.</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="python" name="458c" id="458c" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><br /><span class="hljs-keyword">def</span> <span class="hljs-title function_">getRegister</span>(<span class="hljs-params">instruction</span>):<br />    registerRegex = <span class="hljs-string">&quot;(%[r][abcd]x|%[r][bsd][ip])&quot;</span><br />    registers = re.findall(registerRegex, instruction)<br />    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(registers) != <span class="hljs-number">0</span>:<br />        registers = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> registers <span class="hljs-keyword">if</span> i] <span class="hljs-comment"># clean list</span><br />        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;found match: mov &quot;</span>,registers[<span class="hljs-number">1</span>],<span class="hljs-string">&quot;,&quot;</span>,registers[<span class="hljs-number">0</span>])<br />        REG, REG1 = substituteMov(registers)<br />    <span class="hljs-keyword">return</span> REG, REG1<br /><br /><span class="hljs-keyword">def</span> <span class="hljs-title function_">substituteMov</span>(<span class="hljs-params">registers</span>):<br />    REG = getMovRegByte(<span class="hljs-string">&quot;push&quot;</span>, registers[<span class="hljs-number">0</span>]) + <span class="hljs-number">0x50</span><br />    REG1 = getMovRegByte(<span class="hljs-string">&quot;pop&quot;</span>, registers[<span class="hljs-number">1</span>]) + <span class="hljs-number">0x50</span><br />    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;transformed to: PUSH&quot;</span>, registers[<span class="hljs-number">0</span>], <span class="hljs-string">&quot;; POP&quot;</span>, registers[<span class="hljs-number">1</span>], <span class="hljs-string">&quot;bytes:&quot;</span>, <span class="hljs-built_in">hex</span>(REG), <span class="hljs-string">&quot;;&quot;</span>, <span class="hljs-built_in">hex</span>(REG1) )<br />    <span class="hljs-keyword">return</span> REG, REG1<br /><br /><span class="hljs-keyword">def</span> <span class="hljs-title function_">getMovRegByte</span>(<span class="hljs-params">instruction, reg</span>):<br />    regByte = <span class="hljs-number">0</span><br />    reg = reg.replace(<span class="hljs-string">&#x27;%&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)<br />    <span class="hljs-keyword">match</span> reg:<br />        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;eax&quot;</span> | <span class="hljs-string">&quot;rax&quot;</span>:<br />            regByte = <span class="hljs-number">0</span><br />        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;ecx&quot;</span> | <span class="hljs-string">&quot;rcx&quot;</span>:<br />            regByte = <span class="hljs-number">1</span><br />        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;edx&quot;</span> | <span class="hljs-string">&quot;rdx&quot;</span>:<br />            regByte = <span class="hljs-number">2</span><br />        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;ebx&quot;</span> | <span class="hljs-string">&quot;rbx&quot;</span>:<br />            regByte = <span class="hljs-number">3</span><br />        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;esp&quot;</span> | <span class="hljs-string">&quot;rsp&quot;</span>:<br />            regByte = <span class="hljs-number">4</span><br />        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;ebp&quot;</span> | <span class="hljs-string">&quot;rbp&quot;</span>:<br />            regByte = <span class="hljs-number">5</span><br />        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;esi&quot;</span> | <span class="hljs-string">&quot;rsi&quot;</span>:<br />            regByte = <span class="hljs-number">6</span><br />        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;edi&quot;</span> | <span class="hljs-string">&quot;rdi&quot;</span>:<br />            regByte = <span class="hljs-number">7</span><br />    <span class="hljs-keyword">if</span> instruction == <span class="hljs-string">&quot;pop&quot;</span>:<br />        regByte = regByte + <span class="hljs-number">8</span><br />    <span class="hljs-keyword">return</span> regByte</span></pre><p name="f539" id="f539" class="graf graf--p graf-after--pre">Now we run our application and the resulting output tells us that a number of instructions have been changed. Let&#39;s see if this has affected the binary.</p><figure name="9f34" id="9f34" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*NGo_Qr6QLDKLP4WVQXDzeA.png" data-width="1081" data-height="241" src="https://cdn-images-1.medium.com/max/800/1*NGo_Qr6QLDKLP4WVQXDzeA.png"><figcaption class="imageCaption">Hash comparison</figcaption></figure><p name="4c1e" id="4c1e" class="graf graf--p graf-after--figure">And indeed there is now a difference between the two files. Next, let&#39;s use a diff program to check on a byte level the differences between the two (app used <a href="https://www.diffnow.com/report" data-href="https://www.diffnow.com/report" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">https://www.diffnow.com/report</a>)</p><figure name="aaf0" id="aaf0" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*hLg0AOrupTTc9a50gCqtKw.png" data-width="1731" data-height="496" src="https://cdn-images-1.medium.com/max/800/1*hLg0AOrupTTc9a50gCqtKw.png"><figcaption class="imageCaption">diff between applications</figcaption></figure><p name="5890" id="5890" class="graf graf--p graf-after--figure">Scrolling through we see that there are major differences between the two apps despite only substituting a single instruction. We also check that the application is running as expected, and it does!</p><p name="7db1" id="7db1" class="graf graf--p graf-after--p">Now we are almost done! because we have one major issue remaining, the program converts the file to the same output every time, so it&#39;s not polymorphism… it&#39;s just morphism… which just does not have the same ring to it! So let&#39;s change that by adding some randomness!</p><p name="989d" id="989d" class="graf graf--p graf-after--p">This makes our morphing loop look like this:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="scss" name="d629" id="d629" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">with <span class="hljs-built_in">open</span>(fileToMorph, &quot;rb+&quot;) as peFile:<br />    for instruction in instructionList:<br />        movRegex = <span class="hljs-string">&quot;mov\s*(%[r][abcd]x|%[r][b][ip]),(%[r][abcd]x|%[r][bsd][ip])&quot;</span><br /><br />        if re.<span class="hljs-built_in">findall</span>(movRegex, instruction.instruction):<br />            if random.<span class="hljs-built_in">randint</span>(<span class="hljs-number">69</span>,<span class="hljs-number">420</span>) &gt; <span class="hljs-number">123</span>:<br />                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\t[&gt;] MOV found at:&quot;</span>, <span class="hljs-built_in">hex</span>(instruction.offset))<br />                REG, REG1 = <span class="hljs-built_in">getRegister</span>(instruction.instruction)<br />                <span class="hljs-built_in">print</span>(REG.<span class="hljs-built_in">to_bytes</span>(<span class="hljs-number">1</span>))<br />                peFile.<span class="hljs-built_in">seek</span>(instruction.offset+textOffset)<br />                peFile.<span class="hljs-built_in">write</span>(REG.<span class="hljs-built_in">to_bytes</span>(<span class="hljs-number">1</span>))<br />                peFile.<span class="hljs-built_in">write</span>(REG1.<span class="hljs-built_in">to_bytes</span>(<span class="hljs-number">1</span>))<br />                peFile.<span class="hljs-built_in">write</span>(b<span class="hljs-string">&#x27;\x90&#x27;</span>)</span></pre><figure name="f654" id="f654" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*icakETEsOMT5wxVvBHKY6w.png" data-width="728" data-height="374" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*icakETEsOMT5wxVvBHKY6w.png"><figcaption class="imageCaption">Different runs produce different hashes</figcaption></figure><p name="cefc" id="cefc" class="graf graf--p graf-after--figure">And there you have it! a script that takes an input file and transforms it by changing assembly instructions at random without impacting functionality.</p><h3 name="1f54" id="1f54" class="graf graf--h3 graf-after--p">Conclusion</h3><p name="b158" id="b158" class="graf graf--p graf-after--h3">So it&#39;s been a ride to get here, we had to learn about assembly, how different instructions work, how to modify binaries, a bit about PE headers and internals, and potentially more. This implementation is by no means anything other than a rough PoC. There is much room for improvement, from the top of my head the most obvious points of improvement are:</p><ul class="postList"><li name="a423" id="a423" class="graf graf--li graf-after--p">implementing more substitution methods like those described in the original talk and their GitHub</li><li name="5284" id="5284" class="graf graf--li graf-after--li">implementing more fancy methods such as JMP trampolins</li><li name="95f0" id="95f0" class="graf graf--li graf-after--li">abusing ‘empty’ space for code flow obfuscation</li></ul><p name="19bd" id="19bd" class="graf graf--p graf-after--li">But that is gonna be all for now, I hope you enjoyed and potentially learned something.</p><h3 name="2f18" id="2f18" class="graf graf--h3 graf-after--p">References</h3><ul class="postList"><li name="5ff0" id="5ff0" class="graf graf--li graf-after--h3"><a href="https://www.youtube.com/watch?v=AucQUjJBJuw&amp;t=1s" data-href="https://www.youtube.com/watch?v=AucQUjJBJuw&amp;t=1s" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">https://www.youtube.com/watch?v=AucQUjJBJuw&amp;t=1s</a></li><li name="7901" id="7901" class="graf graf--li graf-after--li"><a href="https://github.com/codewhitesec/Lastenzug/tree/main/LastenPIC/SpiderPIC" data-href="https://github.com/codewhitesec/Lastenzug/tree/main/LastenPIC/SpiderPIC" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">https://github.com/codewhitesec/Lastenzug/tree/main/LastenPIC/SpiderPIC</a></li><li name="08c1" id="08c1" class="graf graf--li graf-after--li"><a href="https://0xrick.github.io/win-internals/pe5/" data-href="https://0xrick.github.io/win-internals/pe5/" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">https://0xrick.github.io/win-internals/pe5/</a></li><li name="79e9" id="79e9" class="graf graf--li graf-after--li"><a href="https://github.com/codewhitesec/Lastenzug/blob/main/LastenPIC/SpiderPIC/src/substitutions.go" data-href="https://github.com/codewhitesec/Lastenzug/blob/main/LastenPIC/SpiderPIC/src/substitutions.go" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">https://github.com/codewhitesec/Lastenzug/blob/main/LastenPIC/SpiderPIC/src/substitutions.go</a></li><li name="11c5" id="11c5" class="graf graf--li graf-after--li"><a href="https://www.cs.virginia.edu/~evans/cs216/guides/x86.html" data-href="https://www.cs.virginia.edu/~evans/cs216/guides/x86.html" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">https://www.cs.virginia.edu/~evans/cs216/guides/x86.html</a></li><li name="5f0e" id="5f0e" class="graf graf--li graf-after--li"><a href="https://kobzol.github.io/davis/" data-href="https://kobzol.github.io/davis/" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">https://kobzol.github.io/davis/</a></li><li name="b5ba" id="b5ba" class="graf graf--li graf-after--li"><a href="http://sparksandflames.com/files/x86InstructionChart.html" data-href="http://sparksandflames.com/files/x86InstructionChart.html" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">http://sparksandflames.com/files/x86InstructionChart.html</a></li><li name="c60f" id="c60f" class="graf graf--li graf-after--li"><a href="https://regex101.com/" data-href="https://regex101.com/" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">https://regex101.com/</a></li><li name="ae0b" id="ae0b" class="graf graf--li graf-after--li"><a href="https://github.com/erocarrera/pefile/blob/wiki/UsageExamples.md#introduction" data-href="https://github.com/erocarrera/pefile/blob/wiki/UsageExamples.md#introduction" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">https://github.com/erocarrera/pefile/blob/wiki/UsageExamples.md#introduction</a></li><li name="82bd" id="82bd" class="graf graf--li graf-after--li graf--trailing"><a href="https://www.diffnow.com/report" data-href="https://www.diffnow.com/report" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">https://www.diffnow.com/report</a></li></ul></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@0x0vid" class="p-author h-card">0x0vid</a> on <a href="https://medium.com/p/7570c1def3e2"><time class="dt-published" datetime="2023-12-08T09:44:36.568Z">December 8, 2023</time></a>.</p><p><a href="https://medium.com/@0x0vid/same-same-but-different-a-dive-into-keyless-polymorphism-7570c1def3e2" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on March 28, 2024.</p></footer></article></body></html>